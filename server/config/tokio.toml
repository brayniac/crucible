# Crucible Server - Tokio Runtime Configuration

runtime = "tokio"

[workers]
threads = 4

[cache]
backend = "segment"
policy = "s3fifo"
heap_size = "1GB"
segment_size = "8MB"
max_value_size = "1MB"
hashtable_power = 16

# Disk tier - extend cache capacity beyond RAM (optional)
# When enabled, evicted items are demoted to disk instead of discarded.
# Uncomment to enable:
# [cache.disk]
# enabled = true
# path = "/var/cache/crucible/disk.dat"
# size = "100GB"
# promotion_threshold = 2    # Promote items accessed > N times to RAM
# sync_mode = "async"        # "sync", "async", or "none"
# recover_on_startup = true  # Recover disk cache on restart

[[listener]]
protocol = "resp"
address = "127.0.0.1:6379"

[[listener]]
protocol = "memcache"
address = "127.0.0.1:11211"

[metrics]
address = "127.0.0.1:9090"

[uring]
sqpoll = false
sqpoll_idle_ms = 1000
buffer_count = 2048
buffer_size = "16KB"
sq_depth = 1024
